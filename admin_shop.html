<!DOCTYPE html>
<html lang="zh-tw">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

	<!--css-->
	<link href="css/bootstrap.css" rel="stylesheet">
	<link href="css/global.css" rel="stylesheet">

	<!--vue-->
	<script src="js/vue.js"></script>
	<script src="js/jquery.min.js"></script>
	<script src="js/axios.js"></script>
	<script src="js/semantic.js"></script>
	<link href="css/semantic.css" rel="stylesheet">
	<link href="css/admin.css" rel="stylesheet">
</head>
<body class="season2">
<div id="vue">

<div class="ui top attached tabular menu">
  <a @click="tab = 'info'" :class="{active: tab == 'info'}" class="item">資訊</a>
  <a @click="tab = 'media'" :class="{active: tab == 'media'}" class="item">影音</a>
  <a @click="tab = 'event'" :class="{active: tab == 'event'}" class="item">活動</a>
  <a @click="tab = 'order'" :class="{active: tab == 'order'}" class="item">訂位</a>
  <button @click="save" class="ui primary button right">儲存</button>
</div>

<div v-if="tab == 'info'">
  商家名稱：<input v-model="name" class="big">
  負責人：<input v-model="boss" class="big">
  電話：<input v-model="phone" class="big">
  地址：<input v-model="address" class="big">
	<iframe :src="'https://www.google.com.tw/maps/place/' + address" style="width: 100%"></iframe>
</div>

<div v-if="tab == 'media'">
  <div v-for="(m, i) in media" class="list">
    <button @click="remove(i)" class="ui button right">刪除</button>
		<img v-if="m.image" :src="m.src" style="height: 100px; vertical-align: baseline">
		<video v-if="m.video" :src="m.src" style="height: 100px"></video>
    <br>說明：<input v-model="media[i].desc" class="big">
	</div>
	<div>
		<label for="file" class="ui button">上傳</label>
		<input id="file" type="file" style="visibility: hidden" @change="upload($event)">
	</div>
</div>

<!--
	
<div v-for="s in selected" v-html="traders[s].name"></div>

<select v-model="select" @change="add()">
  <option value="">請選人</option>
  <option v-for="(t,i) in traders" :value="i" v-text="t.name"></option>
</select>
<div class="ui sub header">Selection</div>
<select v-model="names" multiple="" class="ui fluid normal dropdown">
  <option value="">Skills</option>
<option v-for="t in traders" :value="t.id" v-text="t.name"></option>

<div v-if="tab == 'event'">
	<div class="ui floating multiple dropdown search normal selection">
		<input type="hidden" id="names" name="country" v-model.lazy="select" @change="changed">
		<i class="dropdown icon"></i>
		<div class="default text">請選人</div>
		<div class="menu">
			<div class="item" v-for="(t,i) in traders" v-bind:data-value="i"><span v-text="t.name"></span></div>
		</div>
	</div>
</div>
-->

</div>

<script>

var data = {
	tab: 'info',
	id: 0,
	name: '',
	boss: '',
	phone: '',
	address: '',
	media: [],
	//select: '',
	//selected: [],
	//names: -1,
  //traders: [],
};

//data//

var vue = new Vue({el: '#vue', data: data, methods: {
  edit: function (id) {
    location.href = "admin_trader2_edit?id=" + id;
  },
  save: function () {
    var x = this.$data;
    delete x.tab;
    axios.post('admin_shop_save', x);
  },
/*
	changed: function () {
		//if (this.select == -1) return;
    this.selected.push(this.select);
  	console.log(this.select);
		//this.traders.splice(this.select, 1);
	},
*/
	remove: function (i) {
		if (!confirm('是否確認刪除?')) return;
		this.media.splice(i, 1);
	},
	upload: function (e) {
		var file = e.target.files[0];
		if (!/^(image|video)/.test(file.type)) {
			alert('請上傳圖檔或影片');
			e.target.value = '';
		}
		console.log(file);
		var reader = new FileReader();
		reader.onload = function (e) {
			file.src = e.target.result;
			if (/^image/.test(file.type))
				file.image = true;
			else
				file.video = true;
			data.media.push(file);
		}
		reader.readAsDataURL(e.target.files[0]);
		e.target.value = '';
	},
}});

$('.ui.dropdown').dropdown();

</script>

</body>
</html>
